# ДМиТИ
- НОД
- Простые числа
- Решето Эратосфена
# НОД

НОД - число, которое является наибольшим общим кратным нескольких чисел. По-другому НОД можно назвать *взаимной простотой чисел*.
Математическое определение НОД:
$$
a_1, a_2, \ldots, a_i, d \in \mathbb{N} : a_i \mid d \iff D(a_1, \ldots, a_i)=d

$$
Из определения НОД следует, что:
- НОД - число, которое делит без остатка числа:
$$
D(a_1, \ldots, a_i)=d \Rightarrow a_i \bmod d=0
$$
- НОД - число, которое делится на все общие делители чисел:
$$
\forall k\le d : \forall i \space k \mid a_i \Rightarrow k \mid d
$$

Свойства НОД:
1. НОД чисел всегда существует и он единственный
$$
!\exists d \ge1:D(a_1, \ldots, a_i) = d
$$
2. если $a_1, \ldots, a_i$ - взаимно простые, то $D(a_1, \ldots, a_i)=1$
$$
\forall i, j \space(i\ne j) \space D(a_i, a_j) = 1 \Rightarrow D(a_1, \ldots, a_i) = 1
$$
3. НОД всегда больше или равен 1 и не превосходит минимальное среди чисел 
$$
1\le D(a_1, \ldots, a_i) \le \min(a_1, \ldots, a_i)
$$
4. При делении чисел на значение, равное НОД, НОД новых чисел приравнивается к 1
$$
D(a_1, \ldots, a_i)=d \iff D\left(\frac{a_1}{d},\ldots, \frac{a_i}{d}\right) = 1
$$
5. Умножение чисел на число *b* увеличивает НОД на это число *b*
$$
D(a_1, \ldots, a_i)=d \iff D(ba_1,\ldots, ba_i) = bd
$$
6. Если *с* делится на все числа, то при делении всех чисел на *c* НОД изменяется на *c*
$$
\displaylines{
\forall i \ b\mid a_i \\
\ D(a_1, \ldots, a_i)=d \Rightarrow D\left(\frac{a_1}{b}, \ldots, \frac{a_i}{b}\right)=\frac{d}{b}
}
$$
7. НОД чисел равен НОДу числа и НОДу оставшихся чисел
$$
D(a_1, \ldots, a_i)=D(D(a_1, \ldots, a_{i-1}), a_i)=d
$$
8. НОД не изменится если от одного числа отнять другое из НОД.
$$
\displaylines{
\forall j,k : j \ne k, \ 1 \le j,k \le i, a_j \ge a_k\\
D(a_1, \ldots, a_i)=D(a_1, \ldots, a_j - a_k, \ldots, a_i)=d
}
$$
9. Если *c* делит *ab* и НОД(a, b) = 1, то c делит *b*
$$
c \mid ab, D(a,c)=1 \Rightarrow c \mid b
$$
#матан

---
# Простые числа

Если натуральное число делится только на ±1 и на ±само себя, то такое число является простым.
$$
p\in \mathbb{N}, p>1, \forall k \ne \pm 1, \pm p \Rightarrow \ p \bmod k \ne 0, \ p \bmod p = 0, \ p \bmod 1 = 0
$$
$\mathbb{P}$ - множество простых чисел.
#### Теорема о простых числах.
Пусть *p* - простое число. Тогда справедливо утверждение: $p \mid ab$ тогда и только тогда, когда $p \mid a$ или $p \mid b$
$$
p\in \mathbb{P}, \ p \mid ab \iff p \mid a \ или \ p \mid b
$$
Доказательство:
Предположим, что $p \nmid a$. Тогда $D(a, p)=1$. Согласно  9-ому свойству НОД следует, что $p \mid b$. Также доказывается в обратную сторону.

#### Лемма
Любое $a\in \mathbb{Z}, a\ne1$ имеет по крайней мере 1 простой делитель.
Доказательство:
Пусть $d_1, \ldots, d_i$ - все положительные делители числа $a$, кроме 1. Возьмём $p=min(d_1,\ldots,d_i)$. $p$ - есть просто число, так как в ином случае оно было бы составным и делители $p$ были бы делителями $a$, что противоречит взятому $p$.

#### Основная теорема теории делимости
Любое число $a \in \mathbb{Z}$ раскладывается и только одним способом на простые сомножители.

Каноническим разложением числа называется разложение, в котором одинаковые множители объединены в степень:
$$
\displaylines{
a=p^\alpha q^\beta r^\gamma\ldots\\
где \ \alpha,\beta,\gamma\ge1
}
$$
Доказательство:
- Существования
Согласно Лемме выше число $a$ имеет простой делитель. Представим $a=p_1a_1$. Проведём аналогичные действия до тех пор, пока $a_1$ не станет простым числом. Получим:
$$
a=\prod_{i=1}^{n} p_i, \ где \ p_i-простое
$$
Объединив одинаковые $p_i$ получим каноническое разложение.
- Единственность
Предположим, что 
$$
a=p_1p_2\ldots p_k=q_1q_2\ldots q_n
$$
Тогда $p_1p_2\ldots p_k \bmod q_1$ = 0, по теореме о простых числах следует, что хотя бы одно число из $p_i$ делится $q_1$. Для определённости возьмём $p_1$. Поскольку $p_1$ и $q_1$ простые, то $p_1=q_1$. Отсюда можем прийти к выражению:
$$
p_2\ldots p_k=q_2\ldots q_n
$$
Проделав шаг выше несколько раз, мы придём к выводу, что $p_i=q_i$ и $k=n$. Таким образом, единственность доказана.
#матан

---
# Решето Эратосфена

Решето Эратосфена - алгоритм, который создан для решения задачи о нахождении всех простых чисел в каком-то интервале. Этот алгоритм позволяет найти все числа не превосходящие некоторое $N$. 

Алгоритм выглядит следующим образом:
```python
def sieveOfEratosthenes(N):
	result = list(range(2, N))
	p = 2
	i = 0
	while p < N:
		removeNonPrimaryElements(array, p, N)
		i += 1
		p = result[i]
	return result

def removeNonPrimaryElements(array, p, N)
	for i in range(2*p, N):
		if i % p == 0:
			array.remove(i)
```
Он работает по следующей логике:
1. Генерируется последовательность всех чисел от 2 до $N - 1$
2. Берётся p=2
3. В каждой итерации цикла удаляются все числа из последовательности, которые делятся на $p$, начиная от $2p$ до $N$, само $p$ меняется на следующее простое число в последовательности.

Классическую реализацию решета Эратосфена можно улучшить благодаря выбрасыванию из последовательности чётных чисел. Реализация алгоритма в таком случае изменится следующим образом:
```python
def sieveOfEratosthenes(N):
	result = [2] + list(range(3, N, 2))
	p = 3
	i = 1
	while p < N:
		removeNonPrimaryElements(array, p, N)
		i += 1
		p = result[i]
	return result

def removeNonPrimaryElements(array, p, N)
	for i in range(p**2, N):
		if i % p == 0:
			array.remove(i)
```
Благодаря игнорированию чётных поиск чисел на удаление элементов из последовательности будет занимать меньше итераций, поскольку пробежка чисел будет происходить от $p^2$ до $N$.

#матан