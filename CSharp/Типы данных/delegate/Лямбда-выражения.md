Лямбда-выражения - это сахарная надстройка над [[Анонимные методы|анонимными методами]] и над обычными методами в частности, которая позволяет сокращать код объявления метода до пары строк.

Лямбда-выражения для анонимных методов используются следующим образом:
```cs
//однострочные лямбда-выражения
x => x + 1; //создаётся делегат типа Func<int, int>
(x,y) => x + y + 1; //создаётся делегат типа Func<int, int, int>
() => 1; //создаётся делегат типа Func<int>
() => Console.WriteLine("hi"); //создаётся делегат типа Action

//многострочные лямбда выражения
(x, y) => 
{
	var z = x + y;
	Console.WriteLine(z);
} //создаётся делегат типа Action<int, int>
```

С лямбда-выражениями может произойти "замыкание" - момент, когда анонимный метод работает с переменной, которая находится в контексте метода, в котором лямбда была написана:
```cs
static void MainX()
{
	bool descending = true;
	Func<string, string, int> cmp =
		(x, y) => x.CompareTo(y) * (descending ? -1 : 1);//тут замыкание переменной descending
	var strings = new[] { "A", "B", "AA" };
	Sort(strings, cmp);
	descending = false;
	Sort(strings, cmp);
	//данный код отработает нормально
}
```

Почему замыкание возможно и как оно обрабатывается? Во время компиляции компилятор определяет переменные, которые попали в замыкание, для этих переменных он создаёт анонимный тип данных и потом начинает воспринимать обращение к этой переменной в лямбда-выражении и методе извне, как обращение к полю анонимного типа.
![[delegateMemoryMap.png]]

Лямбда-выражения для обычных методов используются в случае если метод содержит в себе одну строчку кода:
```cs
public int Add(int a, int b)
{
	return a + b;
}

public int Add(int a, int b) => a + b; // запись аналогична методу выше
```

#CSharp 